<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="MendelianRandomization">
<title>Graphical summaries of results • MendelianRandomization</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Graphical summaries of results">
<meta property="og:description" content="MendelianRandomization">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">MendelianRandomization</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Data_Input.html">Data Input</a>
    <a class="dropdown-item" href="../articles/Univariable_MR_Methods.html">Univariable estimation methods</a>
    <a class="dropdown-item" href="../articles/Multivariable_MR_Methods.html">Multivariable estimation methods</a>
    <a class="dropdown-item" href="../articles/Graphs_for_MR.html">Graphical summaries of results</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/sb452/MendelianRandomizationVignette/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Graphical summaries of results</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/sb452/MendelianRandomizationVignette/blob/HEAD/vignettes/Graphs_for_MR.Rmd" class="external-link"><code>vignettes/Graphs_for_MR.Rmd</code></a></small>
      <div class="d-none name"><code>Graphs_for_MR.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="mrinput-object-display-the-data">MRInput Object: display the data<a class="anchor" aria-label="anchor" href="#mrinput-object-display-the-data"></a>
</h2>
<p>The <em>mr_plot</em> function has two different functionalities.
First, if the function is applied to an <em>MRInput</em> object, then
the output is an interactive graph that can be used to explore the
associations of the different genetic variants and look for outliers,
which may represent pleiotropic variants.</p>
<p>The syntax is:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mr_plot.html">mr_plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/mr_input.html">mr_input</a></span><span class="op">(</span>bx <span class="op">=</span> <span class="va">ldlc</span>, bxse <span class="op">=</span> <span class="va">ldlcse</span>, by <span class="op">=</span> <span class="va">chdlodds</span>, byse <span class="op">=</span> <span class="va">chdloddsse</span><span class="op">)</span>,</span>
<span> error <span class="op">=</span> <span class="cn">TRUE</span>, orientate <span class="op">=</span> <span class="cn">FALSE</span>, line <span class="op">=</span> <span class="st">"ivw"</span><span class="op">)</span></span></code></pre></div>
<p>An interactive graph does not reproduce well in a vignette, so we
encourage readers to input this code for themselves. The interactive
graph allows the user to pinpoint outliers easily; when the user mouses
over one of the points, the name of the variant is shown.</p>
<p>The option <em>error = TRUE</em> plots error bars (95% confidence
intervals) for the associations with the exposure and with the outcome.
The option <em>orientate = TRUE</em> sets all the associations with the
exposure to be positive, and re-orientates the associations with the
outcome if needed. This option is encouraged for the MR-Egger method (as
otherwise points having negative associations with the exposure can
appear to be far from the regression line), although by default it is
set to <em>FALSE</em>. The <em>line</em> option can be set to
<em>“ivw”</em> (to show the inverse-variance weighted estimate) or to
<em>“egger”</em> (to show the MR-Egger estimate).</p>
<p>A static version of this graph is also available, by setting
<em>interactive = FALSE</em>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mr_plot.html">mr_plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/mr_input.html">mr_input</a></span><span class="op">(</span>bx <span class="op">=</span> <span class="va">ldlc</span>, bxse <span class="op">=</span> <span class="va">ldlcse</span>, by <span class="op">=</span> <span class="va">chdlodds</span>, byse <span class="op">=</span> <span class="va">chdloddsse</span><span class="op">)</span>,</span>
<span> error <span class="op">=</span> <span class="cn">TRUE</span>, orientate <span class="op">=</span> <span class="cn">FALSE</span>, line <span class="op">=</span> <span class="st">"ivw"</span>, interactive <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="Graphs_for_MR_files/figure-html/unnamed-chunk-3-1.png" width="700" style="display: block; margin: auto;"></p>
<p>This version of the graph is less useful for detecting outliers, but
easier to save as a file and share with colleagues.</p>
<p>Outliers can be identified using the <em>labels = TRUE</em>
option:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mr_plot.html">mr_plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/mr_input.html">mr_input</a></span><span class="op">(</span>bx <span class="op">=</span> <span class="va">ldlc</span>, bxse <span class="op">=</span> <span class="va">ldlcse</span>, by <span class="op">=</span> <span class="va">chdlodds</span>, byse <span class="op">=</span> <span class="va">chdloddsse</span><span class="op">)</span>,</span>
<span> error <span class="op">=</span> <span class="cn">TRUE</span>, orientate <span class="op">=</span> <span class="cn">FALSE</span>, line <span class="op">=</span> <span class="st">"ivw"</span>, interactive <span class="op">=</span> <span class="cn">FALSE</span>, labels <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="Graphs_for_MR_files/figure-html/unnamed-chunk-4-1.png" width="700" style="display: block; margin: auto;"></p>
<p>The resulting graph is quite ugly, but it is easy to identify the
individual points.</p>
</div>
<div class="section level2">
<h2 id="mrmvinput-object-display-the-data">MRMVInput object: display the data<a class="anchor" aria-label="anchor" href="#mrmvinput-object-display-the-data"></a>
</h2>
<p>The <em>mr_plot</em> command can also be applied to an
<em>MRMVInput</em> object created using the <em>mr_mvinput()</em>
function. In this case, the horizontal axis does not present the
associations with any single exposure, but the fitted value from the
multivariable IVW method, representing the expected genetic association
with the outcome based on the genetic associations with the
exposures.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MVMRInputObject</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mr_mvinput.html">mr_mvinput</a></span><span class="op">(</span>bx <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">ldlc</span>, <span class="va">hdlc</span>, <span class="va">trig</span><span class="op">)</span>,</span>
<span>                              bxse <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">ldlcse</span>, <span class="va">hdlcse</span>, <span class="va">trigse</span><span class="op">)</span>,</span>
<span>                              by <span class="op">=</span> <span class="va">chdlodds</span>, </span>
<span>                              byse <span class="op">=</span> <span class="va">chdloddsse</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/mr_plot.html">mr_plot</a></span><span class="op">(</span><span class="va">MVMRInputObject</span>, interactive <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="Graphs_for_MR_files/figure-html/unnamed-chunk-5-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="mrall-object---comparison-of-estimates">MRAll object - comparison of estimates<a class="anchor" aria-label="anchor" href="#mrall-object---comparison-of-estimates"></a>
</h2>
<p>Finally, if the <em>mr_plot</em> function is applied to the output of
the <em>mr_allmethods</em> function, estimates from the different
methods can be compared graphically.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MRInputObject</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mr_input.html">mr_input</a></span><span class="op">(</span>bx <span class="op">=</span> <span class="va">ldlc</span>, </span>
<span>                          bxse <span class="op">=</span> <span class="va">ldlcse</span>, </span>
<span>                          by <span class="op">=</span> <span class="va">chdlodds</span>, </span>
<span>                          byse <span class="op">=</span> <span class="va">chdloddsse</span><span class="op">)</span> <span class="co">#put data into MR input format</span></span>
<span><span class="va">MRAllObject_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mr_allmethods.html">mr_allmethods</a></span><span class="op">(</span><span class="va">MRInputObject</span>, method <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span> <span class="co">#apply all MR methods </span></span>
<span></span>
<span><span class="fu"><a href="../reference/mr_plot.html">mr_plot</a></span><span class="op">(</span><span class="va">MRAllObject_all</span><span class="op">)</span> <span class="co"># create plot</span></span></code></pre></div>
<p><img src="Graphs_for_MR_files/figure-html/unnamed-chunk-6-1.png" width="700" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MRAllObject_egger</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mr_allmethods.html">mr_allmethods</a></span><span class="op">(</span><span class="va">MRInputObject</span>, method <span class="op">=</span> <span class="st">"egger"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/mr_plot.html">mr_plot</a></span><span class="op">(</span><span class="va">MRAllObject_egger</span><span class="op">)</span></span></code></pre></div>
<p><img src="Graphs_for_MR_files/figure-html/unnamed-chunk-7-1.png" width="700" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mr_plot.html">mr_plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/mr_allmethods.html">mr_allmethods</a></span><span class="op">(</span><span class="fu"><a href="../reference/mr_input.html">mr_input</a></span><span class="op">(</span>bx <span class="op">=</span> <span class="va">hdlc</span>, bxse <span class="op">=</span> <span class="va">hdlcse</span>,</span>
<span>  by <span class="op">=</span> <span class="va">chdlodds</span>, byse <span class="op">=</span> <span class="va">chdloddsse</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Graphs_for_MR_files/figure-html/unnamed-chunk-8-1.png" width="700" style="display: block; margin: auto;"></p>
<p>We see that estimates from all methods are similar when
LDL-cholesterol is the risk factor, but the MR-Egger estimates differ
substantially when HDL-cholesterol is the risk factor.</p>
</div>
<div class="section level2">
<h2 id="other-graphical-functions">Other graphical functions<a class="anchor" aria-label="anchor" href="#other-graphical-functions"></a>
</h2>
<p>Other graphical functions are the <em>mr_forest</em> command, which
can either provide a forest plot of the variant-specific estimates:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mr_forest.html">mr_forest</a></span><span class="op">(</span><span class="va">MRInputObject</span>, ordered<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="Graphs_for_MR_files/figure-html/unnamed-chunk-9-1.png" width="700" style="display: block; margin: auto;"></p>
<p>Or the comparison of various estimates from different methods:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mr_forest.html">mr_forest</a></span><span class="op">(</span><span class="va">MRInputObject</span>,</span>
<span>          methods <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ivw"</span>, <span class="st">"median"</span>, <span class="st">"wmedian"</span>, <span class="st">"egger"</span>, <span class="st">"maxlik"</span>, <span class="st">"mbe"</span>, <span class="st">"conmix"</span><span class="op">)</span>,</span>
<span>          snp_estimates <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="Graphs_for_MR_files/figure-html/unnamed-chunk-10-1.png" width="700" style="display: block; margin: auto;"></p>
<p>The <em>mr_funnel</em> command, which provides a funnel plot of the
variant-specific estimates against their precision (that is, the
reciprocal of the standard error):</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="fu"><a href="../reference/mr_funnel.html">mr_funnel</a></span><span class="op">(</span><span class="fu"><a href="../reference/mr_input.html">mr_input</a></span><span class="op">(</span>bx <span class="op">=</span> <span class="va">ldlc</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span>, bxse <span class="op">=</span> <span class="va">ldlcse</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span>,</span>
<span>            by <span class="op">=</span> <span class="va">chdlodds</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span>, byse <span class="op">=</span> <span class="va">chdloddsse</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Graphs_for_MR_files/figure-html/unnamed-chunk-11-1.png" width="700" style="display: block; margin: auto;"></p>
<p>(Note we only plot the first 8 variants here)</p>
<p>And the <em>mr_loo</em> command, which provides the leave-one-out
estimates - that is, the estimate based on all variants except variant
1, then the based on all variants except variant 2, and so on.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mr_loo.html">mr_loo</a></span><span class="op">(</span><span class="va">MRInputObject</span><span class="op">)</span></span></code></pre></div>
<p><img src="Graphs_for_MR_files/figure-html/unnamed-chunk-12-1.png" width="700" style="display: block; margin: auto;"></p>
<p>These plots are all <em>ggplot</em> objects, and so can be edited
using commands from the <em>ggplot2</em> package. For example, to set
the x-axis to run from -5 to +5:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="va">forest</span>  <span class="op">=</span> <span class="fu"><a href="../reference/mr_forest.html">mr_forest</a></span><span class="op">(</span><span class="fu"><a href="../reference/mr_input.html">mr_input</a></span><span class="op">(</span><span class="va">ldlc</span>, <span class="va">ldlcse</span>, <span class="va">chdlodds</span>, <span class="va">chdloddsse</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">forest2</span> <span class="op">=</span> <span class="va">forest</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">forest2</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Stephen Burgess, Olena Yavorska, James Staley.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
