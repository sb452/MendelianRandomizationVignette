<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="The mr_pcgmm function performs multivariable Mendelian randomization via the principal components generalized method of moments method."><title>Univariable principal components generalized method of moments (PC-GMM) method — mr_pcgmm • MendelianRandomization</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Univariable principal components generalized method of moments (PC-GMM) method — mr_pcgmm"><meta property="og:description" content="The mr_pcgmm function performs multivariable Mendelian randomization via the principal components generalized method of moments method."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">MendelianRandomization</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Data_Input.html">Data Input</a>
    <a class="dropdown-item" href="../articles/Univariable_MR_Methods.html">Univariable estimation methods</a>
    <a class="dropdown-item" href="../articles/Multivariable_MR_Methods.html">Multivariable estimation methods</a>
    <a class="dropdown-item" href="../articles/Graphs_for_MR.html">Graphical summaries of results</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/sb452/MendelianRandomizationVignette/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Univariable principal components generalized method of moments (PC-GMM) method</h1>
      <small class="dont-index">Source: <a href="https://github.com/sb452/MendelianRandomizationVignette/blob/HEAD/R/AllGenerics.R" class="external-link"><code>R/AllGenerics.R</code></a>, <a href="https://github.com/sb452/MendelianRandomizationVignette/blob/HEAD/R/mr_pcgmm-methods.R" class="external-link"><code>R/mr_pcgmm-methods.R</code></a></small>
      <div class="d-none name"><code>mr_pcgmm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The <code>mr_pcgmm</code> function performs multivariable Mendelian randomization via the principal components generalized method of moments method.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mr_pcgmm</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">nx</span>,</span>
<span>  <span class="va">ny</span>,</span>
<span>  r <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  thres <span class="op">=</span> <span class="fl">0.999</span>,</span>
<span>  robust <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for MRInput</span></span>
<span><span class="fu">mr_pcgmm</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">nx</span>,</span>
<span>  <span class="va">ny</span>,</span>
<span>  r <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  thres <span class="op">=</span> <span class="fl">0.999</span>,</span>
<span>  robust <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p>An <code>MRInput</code> object.</p></dd>


<dt>nx</dt>
<dd><p>The sample size used to compute genetic associations with the exposure.</p></dd>


<dt>ny</dt>
<dd><p>The sample size used to compute genetic associations with the outcome.</p></dd>


<dt>r</dt>
<dd><p>The number of genetic principal components to be used to instrument the exposure. Default chooses <code>r</code> to explain 99.9% of variation in a sample weighted genetic correlation matrix (this can be varied by setting the <code>thres</code> parameter).</p></dd>


<dt>thres</dt>
<dd><p>The threshold value of variation in the sample weighted genetic correlation matrix explained by the genetic principal components. The default value is 0.999, indicating that 99.9% of variation is explained by the principal components. Note that if <code>r</code> and <code>thres</code> are both specified, then <code>r</code> will take precedence and <code>thres</code> will be ignored.</p></dd>


<dt>robust</dt>
<dd><p>Indicates whether overdispersion heterogeneity is accounted for in the model. Default is TRUE.</p></dd>


<dt>alpha</dt>
<dd><p>The significance level used to calculate the confidence interval. The default value is 0.05.</p></dd>


<dt>...</dt>
<dd><p>Additional arguments to be passed to the optimization routines to calculate the GMM estimate and overdispersion parameter.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>The output from the function is an <code>PCGMM</code> object containing:</p>
<dl><dt>Robust</dt>
<dd><p><code>TRUE</code> if overdispersion heterogeneity was included in the model, <code>FALSE</code> otherwise.</p></dd>

 <dt>Exposure</dt>
<dd><p>A character string with the name given to the exposure.</p></dd>

 <dt>Outcome</dt>
<dd><p>A character string with the names given to the outcome.</p></dd>

 <dt>Correlation</dt>
<dd><p>The matrix of genetic correlations.</p></dd>

 <dt>Estimate</dt>
<dd><p>The causal estimate.</p></dd>

 <dt>StdError</dt>
<dd><p>The standard error of the causal estimate.</p></dd>

 <dt>CILower</dt>
<dd><p>The lower bound of the causal estimate based on the estimated standard error and the significance level provided.</p></dd>

 <dt>CIUpper</dt>
<dd><p>The upper bound of the causal estimate based on the estimated standard error and the significance level provided.</p></dd>

 <dt>Fstat</dt>
<dd><p>The first-stage F statistic for all genetic principal components used as instruments.</p></dd>

 <dt>Overdispersion</dt>
<dd><p>The estimate of the overdispersion parameter.</p></dd>

 <dt>PCs</dt>
<dd><p>The number of genetic principal components used to instrument the exposure.</p></dd>

 <dt>Pvalue</dt>
<dd><p>The p-values associated with the estimates (calculated as Estimate/StdError as per Wald test) using a normal distribution.</p></dd>

 <dt>Alpha</dt>
<dd><p>The significance level used when calculating the confidence intervals.</p></dd>

 <dt>Heter.Stat</dt>
<dd><p>Heterogeneity statistic (Cochran's Q statistic) and associated p-value (for non-robust model only): the null hypothesis is that all genetic principal components estimate the same causal parameter; rejection of the null is an indication that one or more principal components may be pleiotropic.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>When a Mendelian randomization analysis is performed using correlated genetic variants from a single gene region, there is a tradeoff between using too few variants (and compromising on power) and using too many variants (in which case, estimates can be highly sensitive to small variation in the correlation matrix). This method performs dimension reduction on a weighted version of the genetic correlation matrix to form principal components based on the genetic variants, which are then used as instruments. It is recommended not to include very highly correlated variants in this method (say, <code>r^2 &gt; 0.95</code>), but the method should cope well with variants correlated below this level.</p>
<p>This function runs a univariable version of the PC-GMM method, which can be used when there are a single exposure associated with variants at a given gene region.</p>
<p>This method provides two-sample univariable Mendelian randomization estimates and associated confidence intervals that account for overdispersion heterogeneity in dimension-reduced genetic associations (when <code>robust = TRUE</code>).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Description of the PC-GMM method: "Robust use of phenotypic heterogeneity at drug target genes for mechanistic insights: application of cis-multivariable Mendelian randomization to GLP1R gene region" (Preprint).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">mr_pcgmm</span><span class="op">(</span><span class="fu"><a href="mr_input.html">mr_input</a></span><span class="op">(</span>bx <span class="op">=</span> <span class="va">calcium</span>, bxse <span class="op">=</span> <span class="va">calciumse</span>,</span></span>
<span class="r-in"><span>   by <span class="op">=</span> <span class="va">fastgluc</span>, byse <span class="op">=</span> <span class="va">fastglucse</span>, correlation <span class="op">=</span> <span class="va">calc.rho</span><span class="op">)</span>, nx<span class="op">=</span><span class="fl">6351</span>, ny<span class="op">=</span><span class="fl">133010</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Univariable principal components generalized method of moments (PC-GMM) method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of principal components used : 5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Robust model with overdispersion heterogeneity.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Method Estimate Std Error 95% CI       p-value F-stat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  PC-GMM    2.435     0.786 0.895, 3.975   0.002   11.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Overdispersion heterogeneity parameter estimate = -12.65081 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Heterogeneity test statistic = 1.6414</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Stephen Burgess, Olena Yavorska, James Staley.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

