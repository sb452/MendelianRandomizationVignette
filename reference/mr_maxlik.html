<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="The mr_maxlik function implements the maximum-likelihood method introduced by Burgess et al (2013)."><title>Maximum-likelihood method — mr_maxlik • MendelianRandomization</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Maximum-likelihood method — mr_maxlik"><meta property="og:description" content="The mr_maxlik function implements the maximum-likelihood method introduced by Burgess et al (2013)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">MendelianRandomization</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Data_Input.html">Data Input</a>
    <a class="dropdown-item" href="../articles/Univariable_MR_Methods.html">Univariable estimation methods</a>
    <a class="dropdown-item" href="../articles/Multivariable_MR_Methods.html">Multivariable estimation methods</a>
    <a class="dropdown-item" href="../articles/Graphs_for_MR.html">Graphical summaries of results</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/sb452/MendelianRandomizationVignette/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Maximum-likelihood method</h1>
      <small class="dont-index">Source: <a href="https://github.com/sb452/MendelianRandomizationVignette/blob/HEAD/R/AllGenerics.R" class="external-link"><code>R/AllGenerics.R</code></a>, <a href="https://github.com/sb452/MendelianRandomizationVignette/blob/HEAD/R/mr_maxlik-methods.R" class="external-link"><code>R/mr_maxlik-methods.R</code></a></small>
      <div class="d-none name"><code>mr_maxlik.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The <code>mr_maxlik</code> function implements the maximum-likelihood method introduced by Burgess et al (2013).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mr_maxlik</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  model <span class="op">=</span> <span class="st">"default"</span>,</span>
<span>  correl <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  psi <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  distribution <span class="op">=</span> <span class="st">"normal"</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for MRInput</span></span>
<span><span class="fu">mr_maxlik</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  model <span class="op">=</span> <span class="st">"default"</span>,</span>
<span>  correl <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  psi <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  distribution <span class="op">=</span> <span class="st">"normal"</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p>An <code>MRInput</code> object.</p></dd>


<dt>model</dt>
<dd><p>What type of model should be used: <code>"default"</code>, <code>"random"</code> or <code>"fixed"</code>. The method naturally estimates a fixed-effect model, assuming that the same causal effect is estimated by each of the genetic variants. However, if there is heterogeneity in the causal estimates of the different variants, then confidence intervals under a fixed-effect model will be overly narrow. The random-effects model adds additional uncertainty by multiplying the standard error by the square-root of the likelihood ratio heterogeneity statistic divided by the number of genetic variants less one (unless this quantity is less than 1, in which case no modification to the standard error is made). This parallels the residual standard error in a regression model (the Cochran Q heterogeneity test statistic is equal to the square of the RSE multiplied by the number of genetic variants less one). The default setting (<code>"default"</code>) is to use a fixed-effect model with 3 genetic variants or fewer, and otherwise to use a random-effects model.</p></dd>


<dt>correl</dt>
<dd><p>If the genetic variants are correlated, then this correlation can be accounted for. The matrix of correlations between must be provided in the <code>MRInput</code> object: the elements of this matrix are the correlations between the individual variants (diagonal elements are 1).</p></dd>


<dt>psi</dt>
<dd><p>The correlation between the association with the exposure and the association with the outcome for each variant resulting from sample overlap.</p></dd>


<dt>distribution</dt>
<dd><p>The type of distribution used to calculate the confidence intervals, can be <code>"normal"</code> (the default option) or <code>"t-dist"</code>.</p></dd>


<dt>alpha</dt>
<dd><p>The significance level used to calculate the confidence interval. The default value is 0.05.</p></dd>


<dt>...</dt>
<dd><p>Additional arguments to be passed to the optimization method.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>The output from the function is an <code>MaxLik</code> object containing:</p>
<dl><dt>Model</dt>
<dd><p>A character string giving the type of model used (<code>"fixed"</code>, <code>"random"</code>, or <code>"default"</code>).</p></dd>

 <dt>Exposure</dt>
<dd><p>A character string giving the name given to the exposure.</p></dd>

 <dt>Outcome</dt>
<dd><p>A character string giving the name given to the outcome.</p></dd>

 <dt>Correlation</dt>
<dd><p>The matrix of genetic correlations.</p></dd>

 <dt>Psi</dt>
<dd><p>The correlation between genetic associations with the exposure and with the outcome.</p></dd>

 <dt>Estimate</dt>
<dd><p>The value of the causal estimate.</p></dd>

 <dt>StdError</dt>
<dd><p>Standard error of the causal estimate.</p></dd>

 <dt>CILower</dt>
<dd><p>The lower bound of the causal estimate based on the estimated standard error and the significance level provided.</p></dd>

 <dt>CIUpper</dt>
<dd><p>The upper bound of the causal estimate based on the estimated standard error and the significance level provided.</p></dd>

 <dt>Alpha</dt>
<dd><p>The significance level used when calculating the confidence intervals.</p></dd>

 <dt>Pvalue</dt>
<dd><p>The p-value associated with the estimate (calculated as Estimate/StdError as per Wald test) using a normal or t-distribution (as specified in <code>distribution</code>).</p></dd>

 <dt>SNPs</dt>
<dd><p>The number of genetic variants (SNPs) included in the analysis.</p></dd>

 <dt>RSE</dt>
<dd><p>The estimated residual standard error from the regression model (always equal to 1, as a fixed-effect model is required.</p></dd>

 <dt>Heter.Stat</dt>
<dd><p>Heterogeneity statistic (likelihood ratio statistic) and associated p-value: the null hypothesis is that all genetic variants estimate the same causal parameter; rejection of the null is an indication that one or more variants may be pleiotropic.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>A likelihood function is defined by assuming that the summarized data for each genetic variant are normally distributed. A bivariate normal distribution is assumed for the associations of each genetic variant with the exposure and with the outcome. The mean of the association with the outcome is taken as the mean association with the exposure multiplied by the causal effect parameter.</p>
<p>Thus, if there are <code>K</code> genetic variants, then <code>K+1</code> parameters are estimated by the method: one for each gene--exposure association, plus the causal parameter. If the number of genetic variants is large, then maximization of this function may be an issue. If the maximum likelihood estimate substantially differs from the inverse-variance weighted estimate, this may indicate that convergence has not occurred in the optimization algorithm.</p>
<p>The variance-covariance matrices for the bivariate normal distributions are obtained from the standard error estimates provided. The correlation <code>psi</code> between genetic associations with the exposure and with the outcome due to sample overlap can be specified; its default value is zero.</p>
<p>Two features why this method may be preferred over the inverse-variance weighted method are the incorporation in the model of uncertainty in the genetic associations with the exposure, and of correlation between the genetic association estimates with exposure and outcome for each variant. The method is implemented both for uncorrelated and correlated genetic variants. It can also be used for a single genetic variant.</p>
<p>The original version of the maximum-likelihood method assumed that all genetic variants identify the same causal estimate; a fixed-effect model. The causal estimate may be overly precise if the fixed-effect model is incorrect and there is substantial heterogeneity in the causal estimates from the different variants. The random-effects analysis implemented here is an ad hoc solution to the problem of heterogeneity, but one that should result in reasonable confidence intervals that incorporate this heterogeneity.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Stephen Burgess, Adam S Butterworth, Simon G Thompson. Mendelian randomization analysis with multiple genetic variants using summarized data. Genetic Epidemiology 2013; 37:658-665. doi: 10.1002/gepi.21758.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">mr_maxlik</span><span class="op">(</span><span class="fu"><a href="mr_input.html">mr_input</a></span><span class="op">(</span>bx <span class="op">=</span> <span class="va">ldlc</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, bxse <span class="op">=</span> <span class="va">ldlcse</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  by <span class="op">=</span> <span class="va">chdlodds</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, byse <span class="op">=</span> <span class="va">chdloddsse</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Maximum-likelihood method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (variants uncorrelated, random-effect model)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of Variants : 10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Method Estimate Std Error 95% CI       p-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  MaxLik    2.989     0.328 2.346, 3.631   0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual standard error =  0.921 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual standard error is set to 1 in calculation of confidence interval when its estimate is less than 1.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Heterogeneity test statistic = 7.6348 on 9 degrees of freedom, (p-value = 0.5713)</span>
<span class="r-in"><span><span class="fu">mr_maxlik</span><span class="op">(</span><span class="fu"><a href="mr_input.html">mr_input</a></span><span class="op">(</span>bx <span class="op">=</span> <span class="va">ldlc</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, bxse <span class="op">=</span> <span class="va">ldlcse</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  by <span class="op">=</span> <span class="va">chdlodds</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, byse <span class="op">=</span> <span class="va">chdloddsse</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span>, psi<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Maximum-likelihood method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (variants uncorrelated, random-effect model)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of Variants : 10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Method Estimate Std Error 95% CI       p-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  MaxLik    2.950     0.305 2.353, 3.547   0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual standard error =  0.989 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual standard error is set to 1 in calculation of confidence interval when its estimate is less than 1.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Heterogeneity test statistic = 8.7982 on 9 degrees of freedom, (p-value = 0.4561)</span>
<span class="r-in"><span><span class="fu">mr_maxlik</span><span class="op">(</span><span class="fu"><a href="mr_input.html">mr_input</a></span><span class="op">(</span><span class="va">calcium</span>, <span class="va">calciumse</span>, <span class="va">fastgluc</span>, <span class="va">fastglucse</span>, corr<span class="op">=</span><span class="va">calc.rho</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Maximum-likelihood method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (variants correlated, random-effect model)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of Variants : 6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Method Estimate Std Error 95% CI       p-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  MaxLik    2.303     0.709 0.914, 3.692   0.001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual standard error =  0.588 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual standard error is set to 1 in calculation of confidence interval when its estimate is less than 1.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Heterogeneity test statistic = 1.7277 on 5 degrees of freedom, (p-value = 0.8854)</span>
<span class="r-in"><span>  <span class="co">## correlated variants</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Stephen Burgess, Olena Yavorska, James Staley.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

