<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="The mr_mbe function implements the mode-based method introduced by Hartwig, Bowden and Davey Smith (2017)."><title>Mode-based method of Hartwig — mr_mbe • MendelianRandomization</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Mode-based method of Hartwig — mr_mbe"><meta property="og:description" content="The mr_mbe function implements the mode-based method introduced by Hartwig, Bowden and Davey Smith (2017)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">MendelianRandomization</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Data_Input.html">Data Input</a>
    <a class="dropdown-item" href="../articles/Univariable_MR_Methods.html">Univariable estimation methods</a>
    <a class="dropdown-item" href="../articles/Multivariable_MR_Methods.html">Multivariable estimation methods</a>
    <a class="dropdown-item" href="../articles/Graphs_for_MR.html">Graphical summaries of results</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/sb452/MendelianRandomizationVignette/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Mode-based method of Hartwig</h1>
      <small class="dont-index">Source: <a href="https://github.com/sb452/MendelianRandomizationVignette/blob/HEAD/R/AllGenerics.R" class="external-link"><code>R/AllGenerics.R</code></a>, <a href="https://github.com/sb452/MendelianRandomizationVignette/blob/HEAD/R/mr_mbe-methods.R" class="external-link"><code>R/mr_mbe-methods.R</code></a></small>
      <div class="d-none name"><code>mr_mbe.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The <code>mr_mbe</code> function implements the mode-based method introduced by Hartwig, Bowden and Davey Smith (2017).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mr_mbe</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  weighting <span class="op">=</span> <span class="st">"weighted"</span>,</span>
<span>  stderror <span class="op">=</span> <span class="st">"simple"</span>,</span>
<span>  phi <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">314159265</span>,</span>
<span>  iterations <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  distribution <span class="op">=</span> <span class="st">"normal"</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for MRInput</span></span>
<span><span class="fu">mr_mbe</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  weighting <span class="op">=</span> <span class="st">"weighted"</span>,</span>
<span>  stderror <span class="op">=</span> <span class="st">"delta"</span>,</span>
<span>  phi <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">314159265</span>,</span>
<span>  iterations <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  distribution <span class="op">=</span> <span class="st">"normal"</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p>An <code>MRInput</code> object.</p></dd>


<dt>weighting</dt>
<dd><p>Whether the analysis should be <code>"weighted"</code> (the default option) or <code>"unweighted"</code>.</p></dd>


<dt>stderror</dt>
<dd><p>Whether standard error estimates should be i) <code>"simple"</code> - calculated as the first-order term from the delta expansion - standard error of the association with the outcome divided by the association with the exposure), or ii) <code>"delta"</code> - calculated as the second-order term from the delta expansion (the default option). The second-order term incorporates uncertainty in the genetic association with the exposure -- this uncertainty is ignored using the simple weighting. The <code>"simple"</code> option is referred to by Hartwig et al as "assuming NOME", and the <code>"delta"</code> option as "not assuming NOME".</p></dd>


<dt>phi</dt>
<dd><p>The choice of bandwidth in the kernel-smoothly density method. A value of 1 (the default value) represents the bandwidth value selected by the modified Silverman's bandwidth rule, as recommended by Hartwig et al. A value of 0.5 represents half that value, and so on.</p></dd>


<dt>seed</dt>
<dd><p>The random seed to use when generating the bootstrap samples used to calculate the confidence intervals (for reproducibility). The default value is 314159265. If set to <code>NA</code>, the random seed will not be set (for example, if the function is used as part of a larger simulation).</p></dd>


<dt>iterations</dt>
<dd><p>Number of iterations to use in the bootstrap procedure.</p></dd>


<dt>distribution</dt>
<dd><p>The type of distribution used to calculate the confidence intervals, can be <code>"normal"</code> (the default option) or <code>"t-dist"</code>.</p></dd>


<dt>alpha</dt>
<dd><p>The significance level used to calculate the confidence interval. The default value is 0.05.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>The output from the function is an <code>MRMBE</code> object containing:</p>
<dl><dt>Exposure</dt>
<dd><p>A character string giving the name given to the exposure.</p></dd>

 <dt>Outcome</dt>
<dd><p>A character string giving the name given to the outcome.</p></dd>

 <dt>Weighting</dt>
<dd><p>A character string <code>"weighted"</code> or <code>"unweighted"</code>.</p></dd>

 <dt>StdErr</dt>
<dd><p>A character string <code>"simple"</code> or <code>"delta"</code>.</p></dd>

 <dt>Phi</dt>
<dd><p>The value of the bandwidth factor.</p></dd>

 <dt>Estimate</dt>
<dd><p>The value of the causal estimate.</p></dd>

 <dt>StdError</dt>
<dd><p>Standard error of the causal estimate.</p></dd>

 <dt>CILower</dt>
<dd><p>The lower bound of the causal estimate based on the estimated standard error and the significance level provided.</p></dd>

 <dt>CIUpper</dt>
<dd><p>The upper bound of the causal estimate based on the estimated standard error and the significance level provided.</p></dd>

 <dt>Alpha</dt>
<dd><p>The significance level used when calculating the confidence intervals.</p></dd>

 <dt>Pvalue</dt>
<dd><p>The p-value associated with the estimate (calculated as Estimate/StdError as per Wald test) using a normal or t-distribution (as specified in <code>distribution</code>).</p></dd>

 <dt>SNPs</dt>
<dd><p>The number of genetic variants (SNPs) included in the analysis.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The mode-based estimation (MBE) method takes the variant-specific ratio estimates from each genetic variant in turn, and calculates the modal estimate. This is implemented by constructing a kernel-smoothed density out of the ratio estimates, and taking the maximum value as the modal estimate. The standard error is calculated by a bootstrap procedure, and confidence intervals based on the estimate having a normal distribution.</p>
<p>The method should give consistent estimates as the sample size increases if a plurality (or weighted plurality) of the genetic variants are valid instruments. This means that the largest group of variants with the same causal estimate in the asymptotic limit are the valid instruments.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Fernando Pires Hartwig, George Davey Smith, Jack Bowden. Robust inference in summary data Mendelian randomization via the zero modal pleiotropy assumption. International Journal of Epidemiology 2017; 46(6): 1985-1998. doi: 10.1093/ije/dyx102.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">mr_mbe</span><span class="op">(</span><span class="fu"><a href="mr_input.html">mr_input</a></span><span class="op">(</span>bx <span class="op">=</span> <span class="va">ldlc</span>, bxse <span class="op">=</span> <span class="va">ldlcse</span>, by <span class="op">=</span> <span class="va">chdlodds</span>, byse <span class="op">=</span> <span class="va">chdloddsse</span><span class="op">)</span>, iterations<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mode-based method of Hartwig et al</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (weighted, delta standard errors [not assuming NOME], bandwidth factor = 1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of Variants : 28 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Method Estimate Std Error 95% CI       p-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     MBE    2.946     1.027 0.933, 4.960   0.004</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------------------------------------------------------------------</span>
<span class="r-in"><span><span class="fu">mr_mbe</span><span class="op">(</span><span class="fu"><a href="mr_input.html">mr_input</a></span><span class="op">(</span>bx <span class="op">=</span> <span class="va">ldlc</span>, bxse <span class="op">=</span> <span class="va">ldlcse</span>, by <span class="op">=</span> <span class="va">chdlodds</span>, byse <span class="op">=</span> <span class="va">chdloddsse</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   phi<span class="op">=</span><span class="fl">0.5</span>, iterations<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mode-based method of Hartwig et al</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (weighted, delta standard errors [not assuming NOME], bandwidth factor = 0.5)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of Variants : 28 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Method Estimate Std Error 95% CI       p-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     MBE    2.666     1.140 0.433, 4.900   0.019</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------------------------------------------------------------------</span>
<span class="r-in"><span><span class="fu">mr_mbe</span><span class="op">(</span><span class="fu"><a href="mr_input.html">mr_input</a></span><span class="op">(</span>bx <span class="op">=</span> <span class="va">ldlc</span>, bxse <span class="op">=</span> <span class="va">ldlcse</span>, by <span class="op">=</span> <span class="va">chdlodds</span>, byse <span class="op">=</span> <span class="va">chdloddsse</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   weighting<span class="op">=</span><span class="st">"weighted"</span>, stderror<span class="op">=</span><span class="st">"delta"</span>, iterations<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mode-based method of Hartwig et al</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (weighted, delta standard errors [not assuming NOME], bandwidth factor = 1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of Variants : 28 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Method Estimate Std Error 95% CI       p-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     MBE    2.946     1.027 0.933, 4.960   0.004</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------------------------------------------------------------------</span>
<span class="r-in"><span><span class="co"># iterations set to 100 to reduce computational time,</span></span></span>
<span class="r-in"><span><span class="co">#  more iterations are recommended in practice</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Stephen Burgess, Olena Yavorska, James Staley.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

