<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="The mr_mvpcgmm function performs multivariable Mendelian randomization via the principal components generalized method of moments method."><title>Multivariable principal components generalized method of moments (PC-GMM) method — mr_mvpcgmm • MendelianRandomization</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Multivariable principal components generalized method of moments (PC-GMM) method — mr_mvpcgmm"><meta property="og:description" content="The mr_mvpcgmm function performs multivariable Mendelian randomization via the principal components generalized method of moments method."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">MendelianRandomization</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Data_Input.html">Data Input</a>
    <a class="dropdown-item" href="../articles/Univariable_MR_Methods.html">Univariable estimation methods</a>
    <a class="dropdown-item" href="../articles/Multivariable_MR_Methods.html">Multivariable estimation methods</a>
    <a class="dropdown-item" href="../articles/Graphs_for_MR.html">Graphical summaries of results</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/sb452/MendelianRandomizationVignette/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Multivariable principal components generalized method of moments (PC-GMM) method</h1>
      <small class="dont-index">Source: <a href="https://github.com/sb452/MendelianRandomizationVignette/blob/HEAD/R/AllGenerics.R" class="external-link"><code>R/AllGenerics.R</code></a>, <a href="https://github.com/sb452/MendelianRandomizationVignette/blob/HEAD/R/mr_mvpcgmm-methods.R" class="external-link"><code>R/mr_mvpcgmm-methods.R</code></a></small>
      <div class="d-none name"><code>mr_mvpcgmm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The <code>mr_mvpcgmm</code> function performs multivariable Mendelian randomization via the principal components generalized method of moments method.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mr_mvpcgmm</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">nx</span>,</span>
<span>  <span class="va">ny</span>,</span>
<span>  cor.x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  r <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  thres <span class="op">=</span> <span class="fl">0.999</span>,</span>
<span>  robust <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for MRMVInput</span></span>
<span><span class="fu">mr_mvpcgmm</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">nx</span>,</span>
<span>  <span class="va">ny</span>,</span>
<span>  cor.x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  r <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  thres <span class="op">=</span> <span class="fl">0.999</span>,</span>
<span>  robust <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p>An <code>MRMVInput</code> object.</p></dd>


<dt>nx</dt>
<dd><p>Vector of sample sizes used to compute genetic associations with the exposure (one for each exposure).</p></dd>


<dt>ny</dt>
<dd><p>The sample size used to compute genetic associations with the outcome.</p></dd>


<dt>cor.x</dt>
<dd><p>Correlation matrix for exposures. Default is to assume the exposures are uncorrelated.</p></dd>


<dt>r</dt>
<dd><p>The number of genetic principal components to be used to instrument the exposures. Default chooses <code>r</code> to explain 99.9% of variation in a sample weighted genetic correlation matrix (this can be varied by setting the <code>thres</code> parameter).</p></dd>


<dt>thres</dt>
<dd><p>The threshold value of variation in the sample weighted genetic correlation matrix explained by the genetic principal components. The default value is 0.999, indicating that 99.9% of variation is explained by the principal components. Note that if <code>r</code> and <code>thres</code> are both specified, then <code>r</code> will take precedence and <code>thres</code> will be ignored.</p></dd>


<dt>robust</dt>
<dd><p>Indicates whether overdispersion heterogeneity is accounted for in the model. Default is TRUE.</p></dd>


<dt>alpha</dt>
<dd><p>The significance level used to calculate the confidence interval. The default value is 0.05.</p></dd>


<dt>...</dt>
<dd><p>Additional arguments to be passed to the optimization routines to calculate GMM estimates and overdispersion parameter.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>The output from the function is an <code>MVPCGMM</code> object containing:</p>
<dl><dt>Robust</dt>
<dd><p><code>TRUE</code> if overdispersion heterogeneity was included in the model, <code>FALSE</code> otherwise.</p></dd>

 <dt>Exposure</dt>
<dd><p>A character vector with the names given to the exposure.</p></dd>

 <dt>Outcome</dt>
<dd><p>A character string with the names given to the outcome.</p></dd>

 <dt>Correlation</dt>
<dd><p>The matrix of genetic correlations.</p></dd>

 <dt>ExpCorrelation</dt>
<dd><p><code>TRUE</code> if an exposure correlation matrix was specified, <code>FALSE</code> otherwise.</p></dd>

 <dt>CondFstat</dt>
<dd><p>A vector of conditional F-statistics (one for each exposure).</p></dd>

 <dt>Estimate</dt>
<dd><p>A vector of causal estimates.</p></dd>

 <dt>StdError</dt>
<dd><p>A vector of standard errors of the causal estimates.</p></dd>

 <dt>CILower</dt>
<dd><p>The lower bounds of the causal estimates based on the estimated standard errors and the significance level provided.</p></dd>

 <dt>CIUpper</dt>
<dd><p>The upper bounds of the causal estimates based on the estimated standard errors and the significance level provided.</p></dd>

 <dt>Overdispersion</dt>
<dd><p>The estimate of the overdispersion parameter.</p></dd>

 <dt>PCs</dt>
<dd><p>The number of genetic principal components used to instrument the exposures.</p></dd>

 <dt>Pvalue</dt>
<dd><p>The p-values associated with the estimates (calculated as Estimate/StdError as per Wald test) using a normal distribution.</p></dd>

 <dt>Alpha</dt>
<dd><p>The significance level used when calculating the confidence intervals.</p></dd>

 <dt>Heter.Stat</dt>
<dd><p>Heterogeneity statistic (Cochran's Q statistic) and associated p-value (for non-robust model only): the null hypothesis is that all genetic principal components estimate the same causal parameter; rejection of the null is an indication that one or more principal components may be pleiotropic.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>When a Mendelian randomization analysis is performed using correlated genetic variants from a single gene region, there is a tradeoff between using too few variants (and compromising on power) and using too many variants (in which case, estimates can be highly sensitive to small variation in the correlation matrix). This method performs dimension reduction on a weighted version of the genetic correlation matrix to form principal components based on the genetic variants, which are then used as instruments. It is recommended not to include very highly correlated variants in this method (say, <code>r^2 &gt; 0.95</code>), but the method should cope well with variants correlated below this level.</p>
<p>This function runs a multivariable version of the PC-GMM method, which can be used when there are distinct exposures associated with variants at a single gene region. Phenotypic heterogeneity (that is, the genetic associations with the exposures are not collinear) at genomic loci encoding drug targets can be exploited by multivariable Mendelian randomization to provide insight on the pathways by which pharmacological interventions may affect disease risk.</p>
<p>This method provides two-sample multivariable Mendelian randomization estimates and associated confidence intervals that account for overdispersion heterogeneity in dimension-reduced genetic associations (when <code>robust = TRUE</code>).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Description of multivariable Mendelian randomization: Stephen Burgess, Simon G Thompson. Multivariable Mendelian Randomization: the use of pleiotropic genetic variants to estimate causal effects. American Journal of Epidemiology 2015; 181(4):251-260. doi: 10.1093/aje/kwu283.</p>
<p>Description of the PC-GMM method: "Robust use of phenotypic heterogeneity at drug target genes for mechanistic insights: application of cis-multivariable Mendelian randomization to GLP1R gene region" (Preprint).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">mr_mvpcgmm</span><span class="op">(</span><span class="fu"><a href="mr_mvinput.html">mr_mvinput</a></span><span class="op">(</span>bx <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">ldlc</span>, <span class="va">hdlc</span>, <span class="va">trig</span><span class="op">)</span>, bxse <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">ldlcse</span>, <span class="va">hdlcse</span>, <span class="va">trigse</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   by <span class="op">=</span> <span class="va">chdlodds</span>, byse <span class="op">=</span> <span class="va">chdloddsse</span>, correlation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ldlc</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, nx<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">17723</span>,<span class="fl">3</span><span class="op">)</span>, ny<span class="op">=</span><span class="fl">17723</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multivariable principal components generalized method of moments (PC-GMM) method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Exposure correlation matrix not specified. Exposures are assumed to be uncorrelated.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of principal components used : 25 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Robust model with overdispersion heterogeneity.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Exposure Estimate Std Error  95% CI       p-value Cond F-stat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  exposure_1    1.695     0.517  0.681, 2.709   0.001        18.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  exposure_2   -0.754     0.759 -2.240, 0.733   0.321        10.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  exposure_3    0.682     0.292  0.110, 1.255   0.020        10.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Overdispersion heterogeneity parameter estimate = 25.5785 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Heterogeneity test statistic = 21.5116</span>
<span class="r-in"><span><span class="co"># Note this example does not use variants from a single gene region, and is provided</span></span></span>
<span class="r-in"><span><span class="co">#  to demonstrate that the code works, rather than to illustrate a recommended use case.</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Stephen Burgess, Olena Yavorska, James Staley.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

