<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="The function extract.pheno.csv extracts summarized data on associations with named exposure and outcome variables from a .csv file provided by PhenoScanner."><title>Extract summarized data from a PhenoScanner .csv file (legacy) — extract.pheno.csv • MendelianRandomization</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Extract summarized data from a PhenoScanner .csv file (legacy) — extract.pheno.csv"><meta property="og:description" content="The function extract.pheno.csv extracts summarized data on associations with named exposure and outcome variables from a .csv file provided by PhenoScanner."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">MendelianRandomization</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Data_Input.html">Data Input</a>
    <a class="dropdown-item" href="../articles/Univariable_MR_Methods.html">Univariable estimation methods</a>
    <a class="dropdown-item" href="../articles/Multivariable_MR_Methods.html">Multivariable estimation methods</a>
    <a class="dropdown-item" href="../articles/Graphs_for_MR.html">Graphical summaries of results</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/sb452/MendelianRandomizationVignette/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Extract summarized data from a PhenoScanner .csv file (legacy)</h1>
      <small class="dont-index">Source: <a href="https://github.com/sb452/MendelianRandomizationVignette/blob/HEAD/R/extract.pheno.csv-function.R" class="external-link"><code>R/extract.pheno.csv-function.R</code></a></small>
      <div class="d-none name"><code>extract.pheno.csv.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The function <code>extract.pheno.csv</code> extracts summarized data on associations with named exposure and outcome variables from a .csv file provided by PhenoScanner.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">extract.pheno.csv</span><span class="op">(</span></span>
<span>  <span class="va">exposure</span>,</span>
<span>  <span class="va">pmidE</span>,</span>
<span>  <span class="va">ancestryE</span>,</span>
<span>  <span class="va">outcome</span>,</span>
<span>  <span class="va">pmidO</span>,</span>
<span>  <span class="va">ancestryO</span>,</span>
<span>  <span class="va">file</span>,</span>
<span>  rsq.proxy <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  snps <span class="op">=</span> <span class="st">"all"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>exposure</dt>
<dd><p>The name of the exposure variable.</p></dd>


<dt>pmidE</dt>
<dd><p>The PubMed ID (PMID) of the publication in which the genetic association estimates with the exposure were originally reported. Some variables are reported in multiple consortia (for example, associations with coronary artery disease by CARDIoGRAM in 2011 [PMID:21378990], by CARDIoGRAMplusC4D in 2013, and again by CARDIoGRAMplusC4D in 2015 [PMID:26343387]). Equally, some publications reported associations on multiple variables (for example, CARDIoGRAMplusC4D in 2015 [PMID:26343387] reported associations with coronary artery disease and with myocardial infarction). By providing the variable name and the PubMed ID, the set of associations is (almost) uniquely identified.</p></dd>


<dt>ancestryE</dt>
<dd><p>The ancestry of individuals in which estimates were obtained. A small number of studies reported genetic association estimates for a single variable in a single publication for multiple ethnicities (for example, associations with log(eGFR creatinine) from CKD-Gen in 2016 [PMID:26831199] were reported for both Europeans and Africans). The combination of exposure name, PubMed ID, and ancestry uniquely defines the set of associations. Providing the ancestry also reminds analysts of the additional complication of conducting Mendelian randomization when associations with the exposure and with the outcome are in individuals of different ancestry. Most association estimates are obtained in <code>"European"</code> or <code>"Mixed"</code> populations, although some are obtained in <code>"African"</code>, <code>"Asian"</code>, or <code>"Hispanic"</code> populations.</p></dd>


<dt>outcome</dt>
<dd><p>The name of the outcome variable.</p></dd>


<dt>pmidO</dt>
<dd><p>The PubMed ID of the publication in which the genetic association estimates with the outcome were originally reported.</p></dd>


<dt>ancestryO</dt>
<dd><p>The ancestry of individuals in which genetic association estimates with the outcome were obtained.</p></dd>


<dt>file</dt>
<dd><p>The file path where the PhenoScanner .csv file can be found.</p></dd>


<dt>rsq.proxy</dt>
<dd><p>A proxy variant is a genetic variant in close correlation (high linkage disequilibrium) with the named variant. If PhenoScanner is run with proxies included, then proxies can be included in the analysis. In the second example below, with log(eGFR creatinine) as the exposure and Tanner stage as the outcome, the association of variant rs12785878 with the outcome is not reported. Instead, rs4944958 is used as a proxy for rs12785878. The association of rs4944958 with the outcome is used in the resulting <code>MRInput</code> object. The correlation between the two variants is reported as <code>R^2 = 1.000</code>. A message will always appear when a proxy variant is included in an analysis in place of the primary variant. The value of <code>rsq.proxy</code> is used as a threshold in the analysis; a variant is only included in the analysis if the value of <code>R^2</code> equals or excedes this threshold. The default option is <code>rsq.proxy = 1</code>, meaning that only perfect proxies are used in the analysis.</p></dd>


<dt>snps</dt>
<dd><p>The names (rsIDs) of the genetic variants to be included in the analysis. The default option is <code>"all"</code>, indicating that all the genetic variants in the .csv file with beta-coefficients and standard errors for their associations with the risk factor and with the outcome should be used in the analysis. Otherwise, only variants whose names are included in the vector of character strings provided as <code>snps</code> will be included in the analysis.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>The output of the <code>extract.pheno.csv</code> function is an <code>MRInput</code> object that can be used directly in any of the estimation functions (such as <code>mr_ivw</code>) or in the plotting function <code>mr_plot</code>. The output contains:</p>
<dl><dt>bx</dt>
<dd><p>The genetic associations with the exposure.</p></dd>

<dt>bxse</dt>
<dd><p>The corresponding standard errors.</p></dd>

<dt>by</dt>
<dd><p>The genetic associations with the outcome.</p></dd>

<dt>byse</dt>
<dd><p>The corresponding standard errors.</p></dd>

<dt>correlation</dt>
<dd><p>The matrix of genetic correlations. Currently, this is set to the empty matrix (<code><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix()</a></code>), meaning that only uncorrelated variants can be used in the <code>extract.pheno.csv</code> function.</p></dd>

<dt>exposure</dt>
<dd><p>A character string giving the name of the exposure as provided in the PhenoScanner database.</p></dd>

<dt>outcome</dt>
<dd><p>A character string giving the name of the outcome as provided in the PhenoScanner database.</p></dd>

<dt>snps</dt>
<dd><p>A vector of character strings with the names of the genetic variants.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Note that this function was written for a previous version of PhenoScanner. It has not been updated, as it has been overtaken by the <code>pheno_input</code> function that queries PhenoScanner directly from R.</p>
<p>The PhenoScanner bioinformatic tool (<a href="http://phenoscanner.medschl.cam.ac.uk/" class="external-link">http://phenoscanner.medschl.cam.ac.uk/</a>) is a curated database of publicly available results from large-scale genetic association studies. Queries can be made for individual genetic variants (SNPs and small indels), or for multiple variants in a single batch query. One of the output files is a .csv file containing all associations of variables with each of the SNPs. For commonly genotyped variants, associations with up to 200 variables may be reported. These association estimates and their standard errors can be used in Mendelian randomization analyses.</p>
<p>The plan is to enable PhenoScanner to be queried directly from the MendelianRandomization package. However, this functionality is currently unavailable.</p>
<p>The <code>extract.pheno.csv</code> function takes the output from the web version of PhenoScanner, and converts this into an <code>MRInput</code> object. PhenoScanner is still under development. This function is designed for output from PhenoScanner version 1.1 (Little Miss Sunshine).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>James R Staley, James Blackshow, Mihir A Kamat, Steve Ellis, Prvaeen Surendran, Benjamin B Sun, Dirk S Paul, Daniel Freitag, Stephen Burgess, John Danesh, Robin Young, and Adam S Butterworth. PhenoScanner: a database of human genotype--phenotype associations. Bioinformatics 2016. doi: 10.1093/bioinformatics/btw373.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">path.noproxy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"vitD_snps_PhenoScanner.csv"</span>,</span></span>
<span class="r-in"><span>package <span class="op">=</span> <span class="st">"MendelianRandomization"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">path.proxies</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"vitD_snps_PhenoScanner_proxies.csv"</span>,</span></span>
<span class="r-in"><span> package <span class="op">=</span> <span class="st">"MendelianRandomization"</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="co"># these two files from PhenoScanner are provided</span></span></span>
<span class="r-in"><span> <span class="co"># as part of the MendelianRandomization package</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">extract.pheno.csv</span><span class="op">(</span></span></span>
<span class="r-in"><span> exposure <span class="op">=</span> <span class="st">"log(eGFR creatinine)"</span>, pmidE <span class="op">=</span> <span class="fl">26831199</span>, ancestryE <span class="op">=</span> <span class="st">"European"</span>,</span></span>
<span class="r-in"><span> outcome <span class="op">=</span> <span class="st">"Tanner stage"</span>, pmidO <span class="op">=</span> <span class="fl">24770850</span>, ancestryO <span class="op">=</span> <span class="st">"European"</span>, </span></span>
<span class="r-in"><span> file <span class="op">=</span> <span class="va">path.noproxy</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          SNP log(eGFR creatinine).beta log(eGFR creatinine).se</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 rs10741657                   -0.0018                 0.00092</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 rs17217119                   -0.0066                 0.00110</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  rs2282679                   -0.0016                 0.00100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Tanner stage.beta Tanner stage.se</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1           -0.0136          0.0135</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2            0.0227          0.0165</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3           -0.0042          0.0148</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">extract.pheno.csv</span><span class="op">(</span></span></span>
<span class="r-in"><span> exposure <span class="op">=</span> <span class="st">"log(eGFR creatinine)"</span>, pmidE <span class="op">=</span> <span class="fl">26831199</span>, ancestryE <span class="op">=</span> <span class="st">"European"</span>,</span></span>
<span class="r-in"><span> outcome <span class="op">=</span> <span class="st">"Tanner stage"</span>, pmidO <span class="op">=</span> <span class="fl">24770850</span>, ancestryO <span class="op">=</span> <span class="st">"European"</span>,</span></span>
<span class="r-in"><span> rsq.proxy <span class="op">=</span> <span class="fl">0.6</span>, file <span class="op">=</span> <span class="va">path.proxies</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Variant rs4944958 used as a proxy for rs12785878 in association with the outcome. R^2 value: 1.000.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          SNP log(eGFR creatinine).beta log(eGFR creatinine).se</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 rs10741657                   -0.0018                 0.00092</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 rs12785878                    0.0024                 0.00100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 rs17217119                   -0.0066                 0.00110</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  rs2282679                   -0.0016                 0.00100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Tanner stage.beta Tanner stage.se</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1           -0.0136          0.0135</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2            0.0102          0.0155</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3            0.0227          0.0165</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4           -0.0042          0.0148</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">extract.pheno.csv</span><span class="op">(</span></span></span>
<span class="r-in"><span> exposure <span class="op">=</span> <span class="st">"log(eGFR creatinine)"</span>, pmidE <span class="op">=</span> <span class="fl">26831199</span>, ancestryE <span class="op">=</span> <span class="st">"European"</span>,</span></span>
<span class="r-in"><span> outcome <span class="op">=</span> <span class="st">"Asthma"</span>, pmidO <span class="op">=</span> <span class="fl">20860503</span>, ancestryO <span class="op">=</span> <span class="st">"European"</span>,</span></span>
<span class="r-in"><span> rsq.proxy <span class="op">=</span> <span class="fl">0.6</span>, file <span class="op">=</span> <span class="va">path.proxies</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Variant rs2060793 used as a proxy for rs10741657 in association with the outcome. R^2 value: 1.000.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Variant rs7944926 used as a proxy for rs12785878 in association with the outcome. R^2 value: 1.000.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          SNP log(eGFR creatinine).beta log(eGFR creatinine).se Asthma.beta</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 rs10741657                   -0.0018                 0.00092     0.00897</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 rs12785878                    0.0024                 0.00100    -0.00353</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 rs17217119                   -0.0066                 0.00110    -0.03906</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  rs2282679                   -0.0016                 0.00100    -0.01241</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Asthma.se</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    0.0202</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    0.0229</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    0.0255</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    0.0220</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Stephen Burgess, Olena Yavorska, James Staley.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

